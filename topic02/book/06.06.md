# Action Implementation

Review this general introduction to App Bar/toolbars here:

- <https://developer.android.com/training/appbar/setting-up.html>


We need to respond to the button press - triggering the launch of the PlacemarkActivity:

## PlacemarkListActivity

~~~
  override fun onOptionsItemSelected(item: MenuItem?): Boolean {
    when (item?.itemId) {
      R.id.item_add -> startActivityForResult<PlacemarkActivity>(AppCompatActivity.RESULT_OK)
    }
    return super.onOptionsItemSelected(item)
  }
~~~

This implements the menu event handler - and if the event it `item_add`, we start the PlacemarkActivity.

We are using the anko intent library:

- <https://github.com/Kotlin/anko/wiki/Anko-Commons-%E2%80%93-Intents>

In this case we are starting an 'intent' inside our own application. The intent systems in Android is more general than this - and we can trigger intents serviced by other applications.

- <https://developer.android.com/training/basics/intents/index.html>

Indeed, we expose an intent to permit one of our activities to be launched.

Run the app now - and add an activity:

- what happens when add activity is pressed?
- what happens when you press the `back` button from AddActivity?

Clearly we are not quite finished yet. In PlacemarkActivity, we need to explicitly finish() the activity - and se a result code:

~~~
...
      if (placemark.title.isNotEmpty()) {
        app.placemarks.add(placemark.copy())
        info("add Button Pressed: $placemarkTitle")
        app.placemarks.forEach { info("add Button Pressed: ${it}")}
        setResult(AppCompatActivity.RESULT_OK)
        finish()
      }
...        
~~~

This should end the PlacemarkActivity - and update the List view.

We can remove the test placemarks from MainApp now:

~~~
  override fun onCreate() {
    super.onCreate()
    info("Placemark started")
    // placemarks.add(PlacemarkModel("One", "About one..."))
    // placemarks.add(PlacemarkModel("Two", "About two..."))
    // placemarks.add(PlacemarkModel("Three", "About three..."))
  }
~~~